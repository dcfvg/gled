# glisser-editer

# USAGE: glisser-editer 
# 

content="/Users/benoit/Dropbox/glisser-editer"

docw=2480
doch=3508
docsize=$docw"x"$doch
last="$content/step/last.jpg"

for pdoc in `find $content/inbox -iname "*.jpg" -type f | xargs ls -rt`
do
  
  box=$(basename $(dirname $pdoc))
  doc=$(basename $pdoc)
  
  blin=${box:0:1}
  bcol=${box:2:1}
    
  filemtime=$(perl -MPOSIX -le 'print strftime "%s",localtime ((stat $ARGV[0])[9])' $pdoc)
  
  
  echo "$box > $doc"
  echo "$box : $blin - $bcol $filemtime"
  
  # resize and archive documents
  
  docarchive="$content/archive/$filemtime.$blin-$bcol.$doc"
  convert -format jpg -resize $docsize -extent $docsize $pdoc $docarchive
  
  step="$content/step/$filemtime.jpg"

  composite $docarchive -geometry "+$((docw*bcol))+$((doch*blin))" $last $step
  
  rm $last
  cp $step $last
  
done