# glisser-editer

# USAGE: glisser-editer 
# 

content="/Users/benoit/Dropbox/glisser-editer"

docw=2480
doch=3508
docsize=$docw"x"$doch
last="$content/step/white.jpg"

parchive="$content/archive"
pinbox="$content/inbox"
pprint="$content/print"
pstep="$content/step"
ptrash="$content/trash"

for pdoc in `find $pinbox -iname "*.jpg" -type f | xargs ls -rt`
do
  
  box=$(basename $(dirname $pdoc))
  doc=$(basename $pdoc)
  
  blin=${box:0:1}
  bcol=${box:2:1}
    
  filemtime=$(perl -MPOSIX -le 'print strftime "%s",localtime ((stat $ARGV[0])[9])' $pdoc)
  
  
  echo "$box > $doc"
  echo "$box : $blin - $bcol $filemtime"
  
  # resize and archive documents
  
  pdocarchive="$parchive/$filemtime.$blin-$bcol.$doc"
  convert -format jpg -resize $docsize -extent $docsize $pdoc $pdocarchive
  
  step="$pstep/$filemtime.jpg"

  composite $docarchive -geometry "+$((docw*bcol))+$((doch*blin))" $last $step
  
  
  mv $pdoc "$ptrash/$box/$doc"
  rm $last
  cp $step $last
  
done